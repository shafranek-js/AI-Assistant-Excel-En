# AI Assistant for Excel (VBA)

Надстройка для Microsoft Excel, которая добавляет AI-ассистента с поддержкой **облачных** и **локальных** LLM моделей.

![Интерфейс настроек](screenshots/settings.png)
![Извлечение данных из изображений](screenshots/image_extraction.png)

## Возможности

### AI-чат с контекстом Excel
- Автоматический сбор контекста: структура данных, заголовки, выделенные ячейки
- Отправка запросов к AI с учётом текущей книги
- Автоматическое выполнение команд — AI сам вносит изменения в таблицу

### Поддержка моделей
**Облачные:**
- DeepSeek (deepseek.com)
- Claude, GPT, Gemini через OpenRouter (openrouter.ai)

**Локальные:**
- LM Studio (любая локальная модель)

### Vision API — работа с изображениями
- Отправка изображений в AI (Claude, GPT, Gemini)
- Извлечение данных из скриншотов, фотографий таблиц
- Автоматическая вставка извлечённых данных в Excel

### Более 400 команд Excel
AI автоматически выполняет команды:

| Категория | Примеры команд |
|-----------|----------------|
| Ячейки | SET_VALUE, SET_FORMULA, FILL_DOWN, COPY, PASTE_VALUES |
| Форматирование | BOLD, FONT_COLOR, FILL_COLOR, BORDER, MERGE |
| Строки/столбцы | INSERT_ROW, DELETE_COLUMN, HIDE_ROW, GROUP_ROWS |
| Сортировка | SORT, FILTER, REMOVE_DUPLICATES, AUTOFILTER |
| Графики | CREATE_CHART, CHART_TITLE, CHART_LEGEND |
| Сводные таблицы | CREATE_PIVOT, PIVOT_ADD_ROW, PIVOT_ADD_VALUE |
| Листы | ADD_SHEET, RENAME_SHEET, PROTECT_SHEET |
| Условное форматирование | COND_HIGHLIGHT, DATA_BARS, COLOR_SCALE |
| Проверка данных | VALIDATION_LIST, VALIDATION_NUMBER |

## Установка

### 1. Скачайте файл
Скачайте `AI_Assistant.xlam` из раздела [Releases](../../releases).

### 2. Поместите в папку надстроек
```
C:\Users\<Имя>\AppData\Roaming\Microsoft\AddIns\
```
или в любую другую папку по вашему выбору.

### 3. Подключите надстройку в Excel
1. **Файл** → **Параметры** → **Надстройки**
2. Внизу: **Управление** → **Надстройки Excel** → **Перейти**
3. Нажмите **Обзор** и выберите `AI_Assistant.xlam`
4. Поставьте галку и нажмите **OK**

### 4. Разрешите макросы
- **Файл** → **Параметры** → **Центр управления безопасностью**
- **Параметры макросов** → **Доверять доступ к объектной модели проектов VBA**

## Настройка API-ключей

### Облачные модели

1. Нажмите кнопку **AI Ассистент** (или Alt+F8 → `ShowAIAssistant`)
2. Нажмите **Настройки**
3. Введите ключи:

| Модель | Где получить |
|--------|--------------|
| DeepSeek | [platform.deepseek.com](https://platform.deepseek.com) |
| Claude/GPT/Gemini | [openrouter.ai](https://openrouter.ai) |

### Локальная модель (LM Studio)

1. Установите [LM Studio](https://lmstudio.ai)
2. Загрузите и запустите модель
3. В настройках надстройки укажите:
   - IP: `127.0.0.1` (или IP другого компьютера)
   - Порт: `1234` (по умолчанию)
4. Нажмите **Обновить** для загрузки списка моделей

## Использование

1. Откройте книгу Excel с данными
2. Нажмите кнопку **AI Ассистент**
3. Выберите режим: **Облачные** или **Локальная**
4. Включите **☑ Включить данные** для передачи выделения в AI
5. Опишите задачу на естественном языке

### Примеры запросов:
- «Добавь столбец с суммой B и C»
- «Отсортируй по дате убывания»
- «Подсвети красным отрицательные числа»
- «Построй график продаж по месяцам»
- «Создай сводную таблицу по регионам»

## Системные требования

- Microsoft Excel 2007 или новее
- Windows 8/10/11
- Интернет для облачных моделей (или LM Studio для локальных)

## Видео-демонстрация

Смотрите примеры работы в папке `videos/`.

## Безопасность

- API-ключи хранятся в реестре Windows (`HKEY_CURRENT_USER\Software\ExcelAIAssistant`)
- Данные отправляются только выбранному API-провайдеру
- При использовании LM Studio данные не покидают ваш компьютер

## Автор

По вопросам доработки: [t.me/koladen](https://t.me/koladen)

## Отказ от ответственности

Автор не несёт ответственности за:
- Повреждение или потерю данных
- Некорректную работу программного обеспечения
- Любой ущерб, возникший в результате использования надстройки

Используйте на свой страх и риск. Рекомендуется создавать резервные копии важных данных перед использованием.

## Лицензия

MIT License — свободное использование и модификация.
